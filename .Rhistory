## Identify rows with NA values - these are outside of the Scottish mainland
NA.vals <- which(is.na(WFD.siteCovs$AWI))
NA.vals <- append(NA.vals, which(is.na(WFD.siteCovs$pet_emerge)))
NA.vals <- append(NA.vals, which(is.na(WFD.siteCovs$wildness)))
NA.vals <- append(NA.vals, which(is.na(WFD.siteCovs$peat)))
WFD.occu.mat <- WFD.occu.mat[-c(NA.vals),]
WFD.siteCovs <- WFD.siteCovs[-c(NA.vals),]
###NEED TO ADD WIND AND potentially tas to this list (could add DTR and radiation?)#########
WFD.obsCov.wind <- read.csv("Data/WFDObsCov_wind.csv")
# Read in site and observation covariates
WFD.siteCovs <- read.csv("Data/EnvVars_FULL.csv")
## Identify rows with NA values - these are outside of the Scottish mainland
NA.vals <- which(is.na(WFD.siteCovs$AWI))
NA.vals <- append(NA.vals, which(is.na(WFD.siteCovs$pet_emerge)))
NA.vals <- append(NA.vals, which(is.na(WFD.siteCovs$wildness)))
NA.vals <- append(NA.vals, which(is.na(WFD.siteCovs$peat)))
###NEED TO ADD WIND AND potentially tas to this list (could add DTR and radiation?)#########
WFD.obsCov.wind <- read.csv("Data/WFDObsCov_wind.csv")
WFD.obsCov.tas <- read.csv("Data/WFDObsCov_tas.csv")
WFD.occu.mat <- WFD.occu.mat[-c(NA.vals),]
WFD.siteCovs <- WFD.siteCovs[-c(NA.vals),]
WFD.obsCov.tas <- WFD.obsCov.tas[-c(NA.vals),]
WFD.obsCov.wind <- WFD.obsCov.wind[-c(NA.vals),]
## Create observation covariates list
WFD.obsCov <- list('AWI' = WFD.siteCovs$AWI, 'wildness' = WFD.siteCovs$wildness, 'wind' = WFD.obsCov.wind, 'tas' = WFD.obsCov.wind)
## Combine conifer/pine and bog/mire/bogwoodland
WFD.siteCovs$coniferpine <- WFD.siteCovs$conifer + WFD.siteCovs$pineforest
WFD.siteCovs$wet <- WFD.siteCovs$bogs + WFD.siteCovs$bogwoodland + WFD.siteCovs$mire
# Create Unmarked data frame
WFD.UMF <- unmarkedFrameOccu(y = WFD.occu.mat, siteCovs = WFD.siteCovs)
nrow(WFD.occu.mat)
nrow(WFD.siteCovs)
# Read in site and observation covariates
WFD.siteCovs <- read.csv("Data/EnvVars_FULL.csv")
nrow(WFD.siteCovs)
## Read in data
WFD.occu.mat <- read.csv("Data/WFDHighland_wide_UMF_FULL.csv")[,2:17]
nrow(WFD.occu.mat)
# Read in site and observation covariates
WFD.siteCovs <- read.csv("Data/EnvVars_FULL.csv")
## Identify rows with NA values - these are outside of the Scottish mainland
NA.vals <- which(is.na(WFD.siteCovs$AWI))
NA.vals <- append(NA.vals, which(is.na(WFD.siteCovs$pet_emerge)))
NA.vals <- append(NA.vals, which(is.na(WFD.siteCovs$wildness)))
NA.vals <- append(NA.vals, which(is.na(WFD.siteCovs$peat)))
NA>vals
NA.vals
WFD.obsCov.wind <- read.csv("Data/WFDObsCov_wind.csv")
WFD.obsCov.tas <- read.csv("Data/WFDObsCov_tas.csv")
nrow(WFD.obsCov.wind)
nrow(WFD.obsCov.tas)
WFD.occu.mat <- WFD.occu.mat[-c(NA.vals),]
WFD.siteCovs <- WFD.siteCovs[-c(NA.vals),]
nrow(WFD.occu.mat)
nrow(WFD.siteCovs)
WFD.obsCov.tas <- WFD.obsCov.tas[-c(NA.vals),]
WFD.obsCov.wind <- WFD.obsCov.wind[-c(NA.vals),]
## Create observation covariates list
WFD.obsCov <- list('AWI' = WFD.siteCovs$AWI, 'wildness' = WFD.siteCovs$wildness, 'wind' = WFD.obsCov.wind, 'tas' = WFD.obsCov.wind)
## Combine conifer/pine and bog/mire/bogwoodland
WFD.siteCovs$coniferpine <- WFD.siteCovs$conifer + WFD.siteCovs$pineforest
WFD.siteCovs$wet <- WFD.siteCovs$bogs + WFD.siteCovs$bogwoodland + WFD.siteCovs$mire
# Create Unmarked data frame
WFD.UMF <- unmarkedFrameOccu(y = WFD.occu.mat, siteCovs = WFD.siteCovs, obsCovs = WFD.obsCov)
?unmarkedFrameOccu
class(WFD.obsCov[[1]])
class(WFD.obsCov[[2]])
class(WFD.obsCov[[3]])
class(WFD.obsCov[[4]])
## Create observation covariates list
WFD.obsCov <- list('AWI' = as.data.frame(WFD.siteCovs$AWI), 'wildness' = as.data.frame(WFD.siteCovs$wildness), 'wind' = WFD.obsCov.wind, 'tas' = WFD.obsCov.wind)
class(WFD.obsCov[[1]])
head(WFD.obsCov[[1]])
## Create observation covariates list
WFD.obsCov <- list('AWI' = as.data.frame('AWI' = WFD.siteCovs$AWI), 'wildness' = as.data.frame('wildness' = WFD.siteCovs$wildness), 'wind' = WFD.obsCov.wind, 'tas' = WFD.obsCov.wind)
?as.data.frame
## Create observation covariates list
WFD.obsCov <- list('AWI' = as.data.frame(WFD.siteCovs$AWI, col.names = 'AWI'), 'wildness' = as.data.frame(WFD.siteCovs$wildness, col.names = 'wildness'), 'wind' = WFD.obsCov.wind, 'tas' = WFD.obsCov.wind)
head(WFD.obsCov[[1]])
# Create Unmarked data frame
WFD.UMF <- unmarkedFrameOccu(y = WFD.occu.mat, siteCovs = WFD.siteCovs, obsCovs = WFD.obsCov)
nrow(WFD.obsCov[[1]])
nrow(WFD.obsCov[[2]])
nrow(WFD.obsCov[[3]])
nrow(WFD.obsCov[[4]])
nrow(WFD.siteCovs)
ncol(WFD.obsCov[[3]])
nrow(WFD.occu.mat)
ncol(WFD.occu.mat)
ncol(WFD.obsCov[[4]])
head(WFD.obsCov[[4]])
WFD.obsCov.AWI <- as.data.frame(WFD.siteCovs$AWI)
for(i in 1:15){
WFD.obsCov.AWI <- cbind(WFD.obsCov.AWI, as.data.frame(WFD.siteCovs$AWI)
}
for(i in 1:15){
WFD.obsCov.AWI <- cbind(WFD.obsCov.AWI, as.data.frame(WFD.siteCovs$AWI))
}
head(WFD.obsCov.AWI)
WFD.obsCov.wildness <- as.data.frame(WFD.siteCovs$wildness)
for(i in 1:15){
WFD.obsCov.wildness <- cbind(WFD.obsCov.wildness, as.data.frame(WFD.siteCovs$wildness))
}
## Create observation covariates list
WFD.obsCov <- list('AWI' = , 'wildness' = as.data.frame(WFD.siteCovs$wildness), 'wind' = WFD.obsCov.wind, 'tas' = WFD.obsCov.wind)
## Create observation covariates list
WFD.obsCov <- list('AWI' = WFD.obsCov.AWI, 'wildness' = WFD.obsCov.wildness, 'wind' = WFD.obsCov.wind, 'tas' = WFD.obsCov.wind)
# Create Unmarked data frame
WFD.UMF <- unmarkedFrameOccu(y = WFD.occu.mat, siteCovs = WFD.siteCovs, obsCovs = WFD.obsCov)
siteCovs(WFD.UMF) <- scale(siteCovs(WFD.UMF))
sC.scale <- scale(siteCovs(WFD.UMF))
obsCovs(WFD.UMF) <- scale(obsCovs(WFD.UMF))
oC.scale <- scale(obsCovs(WFD.UMF))
### Candidate models obsCovs
WFD.occu.obs.1 <- occu(~1 ~1, WFD.UMF)
WFD.occu.obs.2 <- occu(~AWI ~1, WFD.UMF)
WFD.occu.obs.3 <- occu(~wildness ~1, WFD.UMF)
WFD.occu.obs.4 <- occu(~wind ~1, WFD.UMF)
WFD.occu.obs.5 <- occu(~tas ~1, WFD.UMF)
WFD.occu.obs.6 <- occu(~AWI + wildness + wind + tas ~1, WFD.UMF)
WFD.occu.obs.7 <- occu(~AWI + wildness + wind ~1, WFD.UMF)
WFD.occu.obs.8 <- occu(~AWI + wildness + tas ~1, WFD.UMF)
WFD.occu.obs.9 <- occu(~AWI + wildness + tas ~1, WFD.UMF)
WFD.occu.obs.10 <- occu(~AWI + wind + tas ~1, WFD.UMF)
WFD.occu.obs.11 <- occu(~wildness + wind + tas ~1, WFD.UMF)
WFD.occu.obs.12 <- occu(~AWI + wildness ~1, WFD.UMF)
WFD.occu.obs.13 <- occu(~AWI + wind ~1, WFD.UMF)
WFD.occu.obs.14 <- occu(~wildness + wind ~1, WFD.UMF)
WFD.occu.obs.15 <- occu(~AWI + tas ~1, WFD.UMF)
WFD.occu.obs.16 <- occu(~wildness + tas ~1, WFD.UMF)
WFD.occu.obs.17 <- occu(~wind + tas ~1, WFD.UMF)
WFD.obs.fits <- fitList(WFD.occu.obs.1, WFD.occu.obs.2, WFD.occu.obs.3, WFD.occu.obs.4, WFD.occu.obs.5, WFD.occu.obs.6, WFD.occu.obs.7, WFD.occu.obs.8, WFD.occu.obs.9, WFD.occu.obs.10, WFD.occu.obs.11, WFD.occu.obs.12, WFD.occu.obs.13, WFD.occu.obs.14, WFD.occu.obs.15, WFD.occu.obs.16, WFD.occu.obs.17)
WFD.occu.obs.17 <- occu(~wind + tas ~1, WFD.UMF)
WFD.obs.fits <- fitList(WFD.occu.obs.1, WFD.occu.obs.2, WFD.occu.obs.3, WFD.occu.obs.4, WFD.occu.obs.5, WFD.occu.obs.6, WFD.occu.obs.7, WFD.occu.obs.8, WFD.occu.obs.9, WFD.occu.obs.10, WFD.occu.obs.11, WFD.occu.obs.12, WFD.occu.obs.13, WFD.occu.obs.14, WFD.occu.obs.15, WFD.occu.obs.16)
WFD.occu.obs.5 <- occu(~tas ~1, WFD.UMF)
which(is.na(WFD.obsCovs_wind))
which(is.na(WFD.obsCovs.wind))
which(is.na(WFD.obsCov.wind))
class(which(is.na(WFD.obsCov.wind)))
setdiff(which(is.na(WFD.obsCov.wind)), which(is.na(WFD>occu.mat)))
setdiff(which(is.na(WFD.obsCov.wind)), which(is.na(WFD.occu.mat)))
setdiff(which(is.na(WFD.obsCov.tas)), which(is.na(WFD.occu.mat)))
NA.vals
NA.vals <- append(NA.vals, setdiff(which(is.na(WFD.obsCov.tas)), which(is.na(WFD.occu.mat))))
NA.vals
WFD.occu.mat <- WFD.occu.mat[-c(NA.vals),]
WFD.siteCovs <- WFD.siteCovs[-c(NA.vals),]
WFD.obsCov.tas <- WFD.obsCov.tas[-c(NA.vals),]
WFD.obsCov.wind <- WFD.obsCov.wind[-c(NA.vals),]
WFD.obsCov.AWI <- as.data.frame(WFD.siteCovs$AWI)
for(i in 1:15){
WFD.obsCov.AWI <- cbind(WFD.obsCov.AWI, as.data.frame(WFD.siteCovs$AWI))
}
WFD.obsCov.wildness <- as.data.frame(WFD.siteCovs$wildness)
for(i in 1:15){
WFD.obsCov.wildness <- cbind(WFD.obsCov.wildness, as.data.frame(WFD.siteCovs$wildness))
}
## Create observation covariates list
WFD.obsCov <- list('AWI' = WFD.obsCov.AWI, 'wildness' = WFD.obsCov.wildness, 'wind' = WFD.obsCov.wind, 'tas' = WFD.obsCov.wind)
## Combine conifer/pine and bog/mire/bogwoodland
WFD.siteCovs$coniferpine <- WFD.siteCovs$conifer + WFD.siteCovs$pineforest
WFD.siteCovs$wet <- WFD.siteCovs$bogs + WFD.siteCovs$bogwoodland + WFD.siteCovs$mire
# Create Unmarked data frame
WFD.UMF <- unmarkedFrameOccu(y = WFD.occu.mat, siteCovs = WFD.siteCovs, obsCovs = WFD.obsCov)
# Scale and centre siteCovs
siteCovs(WFD.UMF) <- scale(siteCovs(WFD.UMF))
sC.scale <- scale(siteCovs(WFD.UMF))
obsCovs(WFD.UMF) <- scale(obsCovs(WFD.UMF))
oC.scale <- scale(obsCovs(WFD.UMF))
WFD.occu.obs.5 <- occu(~tas ~1, WFD.UMF)
WFD.occu.obs.3 <- occu(~wildness ~1, WFD.UMF)
summary(WFD.siteCovs)
WFD.occu.obs.5 <- occu(~tas ~1, WFD.UMF)
setdiff(which(is.na(WFD.obsCov.wind)), which(is.na(WFD.occu.mat)))
setdiff(which(is.na(WFD.obsCov.tas)), which(is.na(WFD.occu.mat)))
NA>vals
NA.vals
NA.vals <- append(NA.vals, setdiff(which(is.na(WFD.obsCov.tas)), which(is.na(WFD.occu.mat))))
?set.diff
?setdiff
# Read in site and observation covariates
WFD.siteCovs <- read.csv("Data/EnvVars_FULL.csv")
## Identify rows with NA values - these are outside of the Scottish mainland
NA.vals <- which(is.na(WFD.siteCovs$AWI))
NA.vals <- append(NA.vals, which(is.na(WFD.siteCovs$pet_emerge)))
NA.vals <- append(NA.vals, which(is.na(WFD.siteCovs$wildness)))
NA.vals <- append(NA.vals, which(is.na(WFD.siteCovs$peat)))
###NEED TO ADD WIND AND potentially tas to this list (could add DTR and radiation?)#########
WFD.obsCov.wind <- read.csv("Data/WFDObsCov_wind.csv")
WFD.obsCov.tas <- read.csv("Data/WFDObsCov_tas.csv")
setdiff(which(is.na(WFD.obsCov.tas)), which(is.na(WFD.occu.mat)))
## Read in data
WFD.occu.mat <- read.csv("Data/WFDHighland_wide_UMF_FULL.csv")[,2:17]
setdiff(which(is.na(WFD.obsCov.tas)), which(is.na(WFD.occu.mat)))
setdiff(which(is.na(WFD.obsCov.tas)), which(is.na(WFD.occu.mat)))/16
setdiff(which(is.na(WFD.obsCov.tas)), which(is.na(WFD.occu.mat))) %/%16
WFD.obs.cov.tas[1559,]
WFD.obsCov.tas[1559,]
WFD.occu.mat[1559,]
WFD.obsCov.wind[1559,]
ncols(WFD.occu.mat)
ncol(WFD.occu.mat)
# Read in site and observation covariates
WFD.siteCovs <- read.csv("Data/EnvVars_FULL.csv")
## Identify rows with NA values - these are outside of the Scottish mainland
NA.vals <- which(is.na(WFD.siteCovs$AWI))
NA.vals <- append(NA.vals, which(is.na(WFD.siteCovs$pet_emerge)))
NA.vals <- append(NA.vals, which(is.na(WFD.siteCovs$wildness)))
NA.vals <- append(NA.vals, which(is.na(WFD.siteCovs$peat)))
###NEED TO ADD WIND AND potentially tas to this list (could add DTR and radiation?)#########
WFD.obsCov.wind <- read.csv("Data/WFDObsCov_wind.csv")
WFD.obsCov.tas <- read.csv("Data/WFDObsCov_tas.csv")
NA.vals <- append(NA.vals, setdiff(which(is.na(WFD.obsCov.tas)), which(is.na(WFD.occu.mat))) %/% ncol(WFD.occu.mat))
WFD.occu.mat <- WFD.occu.mat[-c(NA.vals),]
WFD.siteCovs <- WFD.siteCovs[-c(NA.vals),]
WFD.obsCov.tas <- WFD.obsCov.tas[-c(NA.vals),]
WFD.obsCov.wind <- WFD.obsCov.wind[-c(NA.vals),]
WFD.obsCov.AWI <- as.data.frame(WFD.siteCovs$AWI)
for(i in 1:15){
WFD.obsCov.AWI <- cbind(WFD.obsCov.AWI, as.data.frame(WFD.siteCovs$AWI))
}
WFD.obsCov.wildness <- as.data.frame(WFD.siteCovs$wildness)
for(i in 1:15){
WFD.obsCov.wildness <- cbind(WFD.obsCov.wildness, as.data.frame(WFD.siteCovs$wildness))
for(i in 1:15){
WFD.obsCov.wildness <- cbind(WFD.obsCov.wildness, as.data.frame(WFD.siteCovs$wildness))
}
}
WFD.obsCov.AWI <- as.data.frame(WFD.siteCovs$AWI)
for(i in 1:15){
WFD.obsCov.AWI <- cbind(WFD.obsCov.AWI, as.data.frame(WFD.siteCovs$AWI))
}
WFD.obsCov.wildness <- as.data.frame(WFD.siteCovs$wildness)
for(i in 1:15){
WFD.obsCov.wildness <- cbind(WFD.obsCov.wildness, as.data.frame(WFD.siteCovs$wildness))
}
WFD.occu.mat <- WFD.occu.mat[-c(NA.vals),]
WFD.siteCovs <- WFD.siteCovs[-c(NA.vals),]
WFD.obsCov.tas <- WFD.obsCov.tas[-c(NA.vals),]
WFD.obsCov.wind <- WFD.obsCov.wind[-c(NA.vals),]
WFD.obsCov.AWI <- as.data.frame(WFD.siteCovs$AWI)
for(i in 1:15){
WFD.obsCov.AWI <- cbind(WFD.obsCov.AWI, as.data.frame(WFD.siteCovs$AWI))
}
WFD.obsCov.wildness <- as.data.frame(WFD.siteCovs$wildness)
for(i in 1:15){
WFD.obsCov.wildness <- cbind(WFD.obsCov.wildness, as.data.frame(WFD.siteCovs$wildness))
}
## Read in data
WFD.occu.mat <- read.csv("Data/WFDHighland_wide_UMF_FULL.csv")[,2:17]
# Read in site and observation covariates
WFD.siteCovs <- read.csv("Data/EnvVars_FULL.csv")
## Identify rows with NA values - these are outside of the Scottish mainland
NA.vals <- which(is.na(WFD.siteCovs$AWI))
NA.vals <- append(NA.vals, which(is.na(WFD.siteCovs$pet_emerge)))
NA.vals <- append(NA.vals, which(is.na(WFD.siteCovs$wildness)))
NA.vals <- append(NA.vals, which(is.na(WFD.siteCovs$peat)))
###NEED TO ADD WIND AND potentially tas to this list (could add DTR and radiation?)#########
WFD.obsCov.wind <- read.csv("Data/WFDObsCov_wind.csv")
WFD.obsCov.tas <- read.csv("Data/WFDObsCov_tas.csv")
NA.vals <- append(NA.vals, setdiff(which(is.na(WFD.obsCov.tas)), which(is.na(WFD.occu.mat))) %/% ncol(WFD.occu.mat))
WFD.occu.mat <- WFD.occu.mat[-c(NA.vals),]
WFD.siteCovs <- WFD.siteCovs[-c(NA.vals),]
WFD.obsCov.tas <- WFD.obsCov.tas[-c(NA.vals),]
WFD.obsCov.wind <- WFD.obsCov.wind[-c(NA.vals),]
WFD.obsCov.AWI <- as.data.frame(WFD.siteCovs$AWI)
for(i in 1:15){
WFD.obsCov.AWI <- cbind(WFD.obsCov.AWI, as.data.frame(WFD.siteCovs$AWI))
}
WFD.obsCov.wildness <- as.data.frame(WFD.siteCovs$wildness)
for(i in 1:15){
WFD.obsCov.wildness <- cbind(WFD.obsCov.wildness, as.data.frame(WFD.siteCovs$wildness))
}
## Create observation covariates list
WFD.obsCov <- list('AWI' = WFD.obsCov.AWI, 'wildness' = WFD.obsCov.wildness, 'wind' = WFD.obsCov.wind, 'tas' = WFD.obsCov.wind)
WFD.siteCovs$coniferpine <- WFD.siteCovs$conifer + WFD.siteCovs$pineforest
WFD.siteCovs$wet <- WFD.siteCovs$bogs + WFD.siteCovs$bogwoodland + WFD.siteCovs$mire
# Create Unmarked data frame
WFD.UMF <- unmarkedFrameOccu(y = WFD.occu.mat, siteCovs = WFD.siteCovs, obsCovs = WFD.obsCov)
# Scale and centre siteCovs
siteCovs(WFD.UMF) <- scale(siteCovs(WFD.UMF))
sC.scale <- scale(siteCovs(WFD.UMF))
obsCovs(WFD.UMF) <- scale(obsCovs(WFD.UMF))
oC.scale <- scale(obsCovs(WFD.UMF))
### Candidate models obsCovs
WFD.occu.obs.1 <- occu(~1 ~1, WFD.UMF)
WFD.occu.obs.2 <- occu(~AWI ~1, WFD.UMF)
WFD.occu.obs.4 <- occu(~wind ~1, WFD.UMF)
WFD.occu.obs.5 <- occu(~tas ~1, WFD.UMF)
summary(WFD.occu.obs.5)
summary(WFD.occu.obs.4)
## Read in data
WFD.occu.mat <- read.csv("Data/WFDHighland_wide_UMF_FULL.csv")[,2:17]
# Read in site and observation covariates
WFD.siteCovs <- read.csv("Data/EnvVars_FULL.csv")
## Identify rows with NA values - these are outside of the Scottish mainland
NA.vals <- which(is.na(WFD.siteCovs$AWI))
NA.vals <- append(NA.vals, which(is.na(WFD.siteCovs$pet_emerge)))
NA.vals <- append(NA.vals, which(is.na(WFD.siteCovs$wildness)))
NA.vals <- append(NA.vals, which(is.na(WFD.siteCovs$peat)))
###NEED TO ADD WIND AND potentially tas to this list (could add DTR and radiation?)#########
WFD.obsCov.wind <- read.csv("Data/WFDObsCov_wind.csv")
WFD.obsCov.tas <- read.csv("Data/WFDObsCov_tas.csv")
#NA.vals <- append(NA.vals, setdiff(which(is.na(WFD.obsCov.tas)), which(is.na(WFD.occu.mat))) %/% ncol(WFD.occu.mat))
WFD.occu.mat <- WFD.occu.mat[-c(NA.vals),]
WFD.siteCovs <- WFD.siteCovs[-c(NA.vals),]
WFD.obsCov.tas <- WFD.obsCov.tas[-c(NA.vals),]
WFD.obsCov.wind <- WFD.obsCov.wind[-c(NA.vals),]
WFD.obsCov.AWI <- as.data.frame(WFD.siteCovs$AWI)
for(i in 1:15){
WFD.obsCov.AWI <- cbind(WFD.obsCov.AWI, as.data.frame(WFD.siteCovs$AWI))
}
WFD.obsCov.wildness <- as.data.frame(WFD.siteCovs$wildness)
for(i in 1:15){
WFD.obsCov.wildness <- cbind(WFD.obsCov.wildness, as.data.frame(WFD.siteCovs$wildness))
}
## Create observation covariates list
WFD.obsCov <- list('AWI' = WFD.obsCov.AWI, 'wildness' = WFD.obsCov.wildness, 'wind' = WFD.obsCov.wind, 'tas' = WFD.obsCov.wind)
## Combine conifer/pine and bog/mire/bogwoodland
WFD.siteCovs$coniferpine <- WFD.siteCovs$conifer + WFD.siteCovs$pineforest
WFD.siteCovs$wet <- WFD.siteCovs$bogs + WFD.siteCovs$bogwoodland + WFD.siteCovs$mire
# Create Unmarked data frame
WFD.UMF <- unmarkedFrameOccu(y = WFD.occu.mat, siteCovs = WFD.siteCovs, obsCovs = WFD.obsCov)
# Scale and centre siteCovs
siteCovs(WFD.UMF) <- scale(siteCovs(WFD.UMF))
sC.scale <- scale(siteCovs(WFD.UMF))
obsCovs(WFD.UMF) <- scale(obsCovs(WFD.UMF))
oC.scale <- scale(obsCovs(WFD.UMF))
### Candidate models obsCovs
WFD.occu.obs.1 <- occu(~1 ~1, WFD.UMF)
WFD.occu.obs.2 <- occu(~AWI ~1, WFD.UMF)
WFD.occu.obs.3 <- occu(~wildness ~1, WFD.UMF)
WFD.occu.obs.4 <- occu(~wind ~1, WFD.UMF)
summary(WFD.occu.obs.4)
NA.vals
## Read in data
WFD.occu.mat <- read.csv("Data/WFDHighland_wide_UMF_FULL.csv")[,2:17]
# Read in site and observation covariates
WFD.siteCovs <- read.csv("Data/EnvVars_FULL.csv")
## Identify rows with NA values - these are outside of the Scottish mainland
NA.vals <- which(is.na(WFD.siteCovs$AWI))
NA.vals <- append(NA.vals, which(is.na(WFD.siteCovs$pet_emerge)))
NA.vals <- append(NA.vals, which(is.na(WFD.siteCovs$wildness)))
NA.vals <- append(NA.vals, which(is.na(WFD.siteCovs$peat)))
###NEED TO ADD WIND AND potentially tas to this list (could add DTR and radiation?)#########
WFD.obsCov.wind <- read.csv("Data/WFDObsCov_wind.csv")
WFD.obsCov.tas <- read.csv("Data/WFDObsCov_tas.csv")
## Missing covariates indicated by model fit below
NA.vals <- append(NA.vals, c(1016, 1027, 1037))
#NA.vals <- append(NA.vals, setdiff(which(is.na(WFD.obsCov.tas)), which(is.na(WFD.occu.mat))) %/% ncol(WFD.occu.mat))
WFD.occu.mat <- WFD.occu.mat[-c(NA.vals),]
WFD.siteCovs <- WFD.siteCovs[-c(NA.vals),]
WFD.obsCov.tas <- WFD.obsCov.tas[-c(NA.vals),]
WFD.obsCov.wind <- WFD.obsCov.wind[-c(NA.vals),]
## Missing covariates indicated by model fit below
WFD.occu.mat <- WFD.occu.mat[-c(1016, 1027, 1037),]
WFD.siteCovs <- WFD.siteCovs[-cc(1016, 1027, 1037),]
## Read in data
WFD.occu.mat <- read.csv("Data/WFDHighland_wide_UMF_FULL.csv")[,2:17]
# Read in site and observation covariates
WFD.siteCovs <- read.csv("Data/EnvVars_FULL.csv")
## Identify rows with NA values - these are outside of the Scottish mainland
NA.vals <- which(is.na(WFD.siteCovs$AWI))
NA.vals <- append(NA.vals, which(is.na(WFD.siteCovs$pet_emerge)))
NA.vals <- append(NA.vals, which(is.na(WFD.siteCovs$wildness)))
NA.vals <- append(NA.vals, which(is.na(WFD.siteCovs$peat)))
###NEED TO ADD WIND AND potentially tas to this list (could add DTR and radiation?)#########
WFD.obsCov.wind <- read.csv("Data/WFDObsCov_wind.csv")
WFD.obsCov.tas <- read.csv("Data/WFDObsCov_tas.csv")
#NA.vals <- append(NA.vals, setdiff(which(is.na(WFD.obsCov.tas)), which(is.na(WFD.occu.mat))) %/% ncol(WFD.occu.mat))
WFD.occu.mat <- WFD.occu.mat[-c(NA.vals),]
WFD.siteCovs <- WFD.siteCovs[-c(NA.vals),]
WFD.obsCov.tas <- WFD.obsCov.tas[-c(NA.vals),]
WFD.obsCov.wind <- WFD.obsCov.wind[-c(NA.vals),]
## Missing covariates indicated by model fit below
WFD.occu.mat <- WFD.occu.mat[-c(1016, 1027, 1037),]
WFD.siteCovs <- WFD.siteCovs[-c(1016, 1027, 1037),]
WFD.obsCov.tas <- WFD.obsCov.tas[-c(1016, 1027, 1037),]
WFD.obsCov.wind <- WFD.obsCov.wind[-c(1016, 1027, 1037),]
WFD.obsCov.AWI <- as.data.frame(WFD.siteCovs$AWI)
for(i in 1:15){
WFD.obsCov.AWI <- cbind(WFD.obsCov.AWI, as.data.frame(WFD.siteCovs$AWI))
}
WFD.obsCov.wildness <- as.data.frame(WFD.siteCovs$wildness)
for(i in 1:15){
WFD.obsCov.wildness <- cbind(WFD.obsCov.wildness, as.data.frame(WFD.siteCovs$wildness))
}
## Create observation covariates list
WFD.obsCov <- list('AWI' = WFD.obsCov.AWI, 'wildness' = WFD.obsCov.wildness, 'wind' = WFD.obsCov.wind, 'tas' = WFD.obsCov.wind)
## Combine conifer/pine and bog/mire/bogwoodland
WFD.siteCovs$coniferpine <- WFD.siteCovs$conifer + WFD.siteCovs$pineforest
WFD.siteCovs$wet <- WFD.siteCovs$bogs + WFD.siteCovs$bogwoodland + WFD.siteCovs$mire
# Create Unmarked data frame
WFD.UMF <- unmarkedFrameOccu(y = WFD.occu.mat, siteCovs = WFD.siteCovs, obsCovs = WFD.obsCov)
# Scale and centre siteCovs
siteCovs(WFD.UMF) <- scale(siteCovs(WFD.UMF))
sC.scale <- scale(siteCovs(WFD.UMF))
obsCovs(WFD.UMF) <- scale(obsCovs(WFD.UMF))
oC.scale <- scale(obsCovs(WFD.UMF))
### Candidate models obsCovs
WFD.occu.obs.1 <- occu(~1 ~1, WFD.UMF)
WFD.occu.obs.4 <- occu(~wind ~1, WFD.UMF)
### Candidate models obsCovs
WFD.occu.obs.1 <- occu(~1 ~1, WFD.UMF)
WFD.occu.obs.2 <- occu(~AWI ~1, WFD.UMF)
WFD.occu.obs.3 <- occu(~wildness ~1, WFD.UMF)
WFD.occu.obs.4 <- occu(~wind ~1, WFD.UMF)
WFD.occu.obs.5 <- occu(~tas ~1, WFD.UMF)
WFD.occu.obs.6 <- occu(~AWI + wildness + wind + tas ~1, WFD.UMF)
#WFD.occu.obs.6 <- occu(~AWI + wildness + wind + tas ~1, WFD.UMF)
WFD.occu.obs.7 <- occu(~AWI + wildness + wind ~1, WFD.UMF)
WFD.occu.obs.8 <- occu(~AWI + wildness + tas ~1, WFD.UMF)
WFD.occu.obs.9 <- occu(~AWI + wildness + tas ~1, WFD.UMF)
WFD.occu.obs.10 <- occu(~AWI + wind + tas ~1, WFD.UMF)
WFD.occu.obs.11 <- occu(~wildness + wind + tas ~1, WFD.UMF)
WFD.occu.obs.12 <- occu(~AWI + wildness ~1, WFD.UMF)
WFD.occu.obs.13 <- occu(~AWI + wind ~1, WFD.UMF)
WFD.occu.obs.14 <- occu(~wildness + wind ~1, WFD.UMF)
WFD.occu.obs.15 <- occu(~AWI + tas ~1, WFD.UMF)
WFD.occu.obs.16 <- occu(~wildness + tas ~1, WFD.UMF)
WFD.occu.obs.17 <- occu(~wind + tas ~1, WFD.UMF)
WFD.obs.fits <- fitList(WFD.occu.obs.1, WFD.occu.obs.2, WFD.occu.obs.3, WFD.occu.obs.4, WFD.occu.obs.5, WFD.occu.obs.7, WFD.occu.obs.8, WFD.occu.obs.9, WFD.occu.obs.10, WFD.occu.obs.11, WFD.occu.obs.12, WFD.occu.obs.13, WFD.occu.obs.14, WFD.occu.obs.15, WFD.occu.obs.16)
WFD.modSel.obs <- modSel(WFD.obs.fits)
WFD.modSel.obs
### Candidate models siteCovs
WFD.occu.1 <- occu(~wildness + wind ~1, WFD.UMF)
WFD.occu.2 <- occu(~wildness + wind~ pineforest*wet + pet_emerge, WFD.UMF)
WFD.occu.3 <- occu(~wildness + wind ~pineforest + pet_emerge + bogs, WFD.UMF)
WFD.occu.4 <- occu(~wildness + wind ~pineforest + pet_emerge + wet, WFD.UMF)
WFD.occu.5 <- occu(~wildness + wind ~pineforest + bogs, WFD.UMF)
WFD.occu.6 <- occu(~wildness + wind ~pineforest + wet, WFD.UMF)
WFD.occu.7 <- occu(~wildness + wind ~pineforest + pet_emerge, WFD.UMF)
WFD.occu.8 <- occu(~wildness + wind ~pineforest*pet_emerge + wet, WFD.UMF)
WFD.occu.9 <- occu(~wildness + wind ~pineforest*pet_emerge + bogs, WFD.UMF)
WFD.occu.10 <- occu(~wildness + wind ~pineforest*pet_emerge, WFD.UMF)
WFD.occu.11 <- occu(~wildness + wind ~pineforest*wet, WFD.UMF)
WFD.occu.12 <- occu(~wildness + wind ~pineforest*bogs, WFD.UMF)
WFD.occu.13 <- occu(~wildness + wind ~pineforest, WFD.UMF)
WFD.occu.14 <- occu(~wildness + wind ~coniferpine + pet_emerge + wet, WFD.UMF)
WFD.occu.15 <- occu(~wildness + wind ~coniferpine*wet + pet_emerge, WFD.UMF)
WFD.occu.16 <- occu(~wildness + wind ~coniferpine*bogs + pet_emerge, WFD.UMF)
WFD.site.fits <- fitList(WFD.occu.1, WFD.occu.2, WFD.occu.3, WFD.occu.4, WFD.occu.5, WFD.occu.6, WFD.occu.7, WFD.occu.8, WFD.occu.9, WFD.occu.10, WFD.occu.11, WFD.occu.12, WFD.occu.13, WFD.occu.14, WFD.occu.15, WFD.occu.16)
WFD.modSel <- modSel(WFD.site.fits)
WFD.modSel
WFD.occu.quad <- occu(~wildness + wind ~coniferpine + I(coniferpine^2) + coniferpine*wet + pet_emerge, WFD.UMF)
AIC(WFD.occu.quad)
summary(WFD.occu.quad)
fitstats <- function(WFD.occu.14) {
observed <- getY(WFD.occu.14@data)
expected <- fitted(WFD.occu.14)
resids <- residuals(WFD.occu.14)
sse <- sum(resids^2,na.rm=TRUE)
chisq <- sum((observed - expected)^2 / expected,na.rm=TRUE)
freeTuke <- sum((sqrt(observed) - sqrt(expected))^2,na.rm=TRUE)
out <- c(SSE=sse, Chisq=chisq, freemanTukey=freeTuke)
return(out)
}
pb <- parboot(WFD.occu.14, fitstats, nsim=10000, report=1)
WFD.occu.check <- occu(~1 ~coniferpine + I(coniferpine^2) + coniferpine*wet + pet_emerge, WFD.UMF)
summary(WFD.occu.check)
WFD.modSel
#### GOF test hangs at 28000 - no error just keeps going?!
WFD.gof <- mb.gof.test(WFD.occu.14, nsim = 10)
WFD.gof
plot(WFD.gof)
layout(matrix(c(1,2,3,4), 2, 2, byrow = TRUE))
layout(matrix(c(1,2,3,4), 2, 2, byrow = TRUE))
new.dat<- data.frame(pineforest=0,wet=seq(-0.49035 ,4.65173,,50))
WFD.occu.14.pred <-predict(WFD.occu.14,type="state",newdata=new.dat,appendData=TRUE)
summary(WFD.occu.14)
plot(WFD.siteCovs$wet, WFD.siteCovs$pet_emerge)
cor(WFD.siteCovs$wet, WFD.siteCovs$pet_emerge)
new.dat<- data.frame(coniferpine=0, pet_emerge = 0, wet=seq(-0.49035 ,4.65173,,50))
WFD.occu.14.pred <-predict(WFD.occu.14,type="state",newdata=new.dat,appendData=TRUE)
head(WFD.occu.14.pred)
wet.mean<- attr(siteCovs(WFD.UMF)$wet,"scaled:center")
wet.sd <- attr(siteCovs(WFD.UMF)$wet,"scaled:scale")
WFD.occu.14.pred$wet <- WFD.occu.14.pred$wet*sd(WFD.siteCovs$wet)+mean(WFD.siteCovs$wet)
plot(Predicted ~ wet, WFD.occu.14.pred,type="l",xlab="Proportion of bog and mire per 0.012 square km",
ylab="Probability of Occupancy",ylim=c(0,1), lwd = 3, cex.lab = 1.3, cex.axis = 1.2)
lines(lower ~ wet, WFD.occu.14.pred,type="l",col="red", lty= 2)
lines(upper ~ wet, WFD.occu.14.pred,type="l",col="red", lty = 2)
head(new.dat)
new.dat<- data.frame(coniferpine=0, pet_emerge = 0, wet=seq(-0.49035 ,4.65173,,50))
WFD.occu.14.pred <-predict(WFD.occu.14,type="state",newdata=new.dat,appendData=TRUE)
head(WFD.occu.14.pred)
WFD.occu.14.pred
wet.mean<- attr(siteCovs(WFD.UMF)$wet,"scaled:center")
wet.sd <- attr(siteCovs(WFD.UMF)$wet,"scaled:scale")
WFD.occu.14.pred$wet <- WFD.occu.14.pred$wet*sd(WFD.siteCovs$wet)+mean(WFD.siteCovs$wet)
plot(Predicted ~ wet, WFD.occu.14.pred,type="l",xlab="Proportion of bog and mire per 0.012 square km",
ylab="Probability of Occupancy",ylim=c(0,1), lwd = 3, cex.lab = 1.3, cex.axis = 1.2)
dev.off()
plot(Predicted ~ wet, WFD.occu.14.pred,type="l",xlab="Proportion of bog and mire per 0.012 square km",
ylab="Probability of Occupancy",ylim=c(0,1), lwd = 3, cex.lab = 1.3, cex.axis = 1.2)
png("test.png")
ylab="Probability of Occupancy",ylim=c(0,1), lwd = 3, cex.lab = 1.3, cex.axis = 1.2)
plot(Predicted ~ wet, WFD.occu.14.pred,type="l",xlab="Proportion of bog and mire per 0.012 square km",
ylab="Probability of Occupancy",ylim=c(0,1), lwd = 3, cex.lab = 1.3, cex.axis = 1.2)
dev.off()
summary(WFD.occu.11)
new.dat<- data.frame(pineforest=0,wet=seq(-0.49035 ,4.65173,,50))
WFD.occu.11.pred <-predict(WFD.occu.11,type="state",newdata=new.dat,appendData=TRUE)
head(WFD.occu.11.pred)
wet.mean<- attr(siteCovs(WFD.UMF)$wet,"scaled:center")
wet.sd <- attr(siteCovs(WFD.UMF)$wet,"scaled:scale")
WFD.occu.11.pred$wet <- WFD.occu.11.pred$wet*sd(WFD.siteCovs$wet)+mean(WFD.siteCovs$wet)
plot(Predicted ~ wet, WFD.occu.11.pred,type="l",xlab="Proportion of bog and mire per 0.012 square km",
ylab="Probability of Occupancy",ylim=c(0,1), lwd = 3, cex.lab = 1.3, cex.axis = 1.2)
summary(WFD.occu.mod.11)
summary(WFD.occu.11)
WFD.occu.11
